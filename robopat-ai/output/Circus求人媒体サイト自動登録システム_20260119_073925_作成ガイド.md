# Circus求人媒体サイト自動登録システム - Robo-Pat DX 作成ガイド

このガイドを参照しながらRobo-Pat DXでスクリプトを作成してください。
各セクションの値はそのままコピペできます。

---
## 1. 変数の設定

Robo-Pat DX の「変数」タブで以下を設定してください：

| 変数名 | 型 | 初期値 | 説明 |
|--------|-----|--------|------|
| `company_count` | STRING | `10` | 処理対象企業数 |
| `current_index` | STRING | `1` | 現在処理中の企業インデックス |
| `company_name` | STRING | `サンプル企業株式会社` | 企業名 |
| `postal_code` | STRING | `100-0001` | 郵便番号 |
| `address` | STRING | `東京都千代田区千代田1-1-1` | 住所 |
| `phone_number` | STRING | `03-1234-5678` | 電話番号 |
| `contact_person` | STRING | `山田太郎` | 担当者名 |
| `email` | STRING | `contact@sample-company.com` | メールアドレス |
| `industry` | STRING | `IT・通信` | 業種 |
| `employee_count` | STRING | `100` | 従業員数 |
| `job_title` | STRING | `システムエンジニア募集` | 求人タイトル |
| `employment_type` | STRING | `正社員` | 雇用形態 |
| `salary` | STRING | `月給25万円～40万円` | 給与 |
| `work_location` | STRING | `東京都内` | 勤務地 |
| `work_hours` | STRING | `9:00～18:00` | 勤務時間 |
| `job_description` | STRING | `システム開発・保守業務` | 仕事内容 |
| `qualifications` | STRING | `IT経験2年以上` | 応募資格 |
| `benefits` | STRING | `社会保険完備、交通費支給` | 福利厚生 |
| `posting_period` | STRING | `30` | 掲載期間（日数） |
| `publish_result` | STRING | `` | 公開結果メッセージ |
| `processed_count` | STRING | `0` | 処理完了件数 |
| `notification_email` | STRING | `admin@company.com` | 通知先メールアドレス |

### コピペ用（変数名）
```
company_count
current_index
company_name
postal_code
address
phone_number
contact_person
email
industry
employee_count
job_title
employment_type
salary
work_location
work_hours
job_description
qualifications
benefits
posting_period
publish_result
processed_count
notification_email
```

---
## 2. コマンドの作成

### タブ: 初期設定・企業マスタ読み込み
> システム初期化と企業マスタファイルの読み込み処理

#### Step 1: comment
**説明:** === Circus求人媒体サイト自動登録システム開始 ===

**操作:** `基本` → `コメント`

**コメント（コピペ用）:**
```
=== Circus求人媒体サイト自動登録システム開始 ===
```

---

#### Step 2: open_chrome
**説明:** Chrome起動

**操作:** `Web操作` → `Chromeを開く`

**URL（コピペ用）:**
```
about:blank
```

---

#### Step 3: comment
**説明:** 企業マスタファイル読み込み処理（実際の環境では別途Excel操作が必要）

**操作:** `基本` → `コメント`

**コメント（コピペ用）:**
```
企業マスタファイル読み込み処理（実際の環境では別途Excel操作が必要）
```

---

### タブ: 企業登録状況確認・新規登録
> Circus企業登録画面での企業登録処理

#### Step 4: open_chrome
**説明:** 企業登録デモ画面を開く

**操作:** `Web操作` → `Chromeを開く`

**URL（コピペ用）:**
```
file:///C:/Users/%USERNAME%/Desktop/circus_company_demo.html
```

---

#### Step 5: wait_for_screen_calms
**説明:** 画面の読み込み完了を待機

**操作:** `基本` → `画面安定待ち`

---

#### Step 6: loop
**説明:** 企業マスタの件数分ループ処理開始

**操作:** `loop`

**オプション:**
- count: `${company_count}`
- variable: `current_index`

---

#### Step 7: try
**説明:** 企業登録処理開始（エラーハンドリング）

**操作:** `フロー制御` → `TRY`

---

#### Step 8: input_text
**説明:** 企業名を入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#company_name
```

**入力値（コピペ用）:**
```
${company_name}
```

---

#### Step 9: input_text
**説明:** 郵便番号を入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#postal_code
```

**入力値（コピペ用）:**
```
${postal_code}
```

---

#### Step 10: input_text
**説明:** 住所を入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#address
```

**入力値（コピペ用）:**
```
${address}
```

---

#### Step 11: input_text
**説明:** 電話番号を入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#phone
```

**入力値（コピペ用）:**
```
${phone_number}
```

---

#### Step 12: input_text
**説明:** 担当者名を入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#contact_person
```

**入力値（コピペ用）:**
```
${contact_person}
```

---

#### Step 13: input_text
**説明:** メールアドレスを入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#email
```

**入力値（コピペ用）:**
```
${email}
```

---

#### Step 14: select
**説明:** 業種を選択

**操作:** `select`

**オプション:**
- selector: `#industry`
- value: `${industry}`
- by: `value`

---

#### Step 15: input_text
**説明:** 従業員数を入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#employee_count
```

**入力値（コピペ用）:**
```
${employee_count}
```

---

#### Step 16: click
**説明:** 企業登録ボタンをクリック

**操作:** `Web操作` → `クリック`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#register_company
```

---

#### Step 17: wait_for_screen_calms
**説明:** 登録処理完了待機

**操作:** `基本` → `画面安定待ち`

---

#### Step 18: catch
**説明:** エラー処理開始

**操作:** `フロー制御` → `CATCH`

---

#### Step 19: comment
**説明:** 企業登録エラー発生 - 次の企業へスキップ

**操作:** `基本` → `コメント`

**コメント（コピペ用）:**
```
企業登録エラー発生 - 次の企業へスキップ
```

---

#### Step 20: end_try
**説明:** エラーハンドリング終了

**操作:** `フロー制御` → `END TRY`

---

### タブ: 求人票作成・公開
> 求人票作成画面での求人情報入力・公開処理

#### Step 21: open_chrome
**説明:** 求人登録画面を開く

**操作:** `Web操作` → `Chromeを開く`

**URL（コピペ用）:**
```
file:///C:/Users/%USERNAME%/Desktop/求人登録.html
```

---

#### Step 22: wait_for_screen_calms
**説明:** 求人登録画面の読み込み完了を待機

**操作:** `基本` → `画面安定待ち`

---

#### Step 23: input_text
**説明:** 求人タイトルを入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#job_title
```

**入力値（コピペ用）:**
```
${job_title}
```

---

#### Step 24: select
**説明:** 雇用形態を選択

**操作:** `select`

**オプション:**
- selector: `#employment_type`
- value: `${employment_type}`
- by: `value`

---

#### Step 25: input_text
**説明:** 給与情報を入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#salary
```

**入力値（コピペ用）:**
```
${salary}
```

---

#### Step 26: input_text
**説明:** 勤務地を入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#work_location
```

**入力値（コピペ用）:**
```
${work_location}
```

---

#### Step 27: input_text
**説明:** 勤務時間を入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#work_hours
```

**入力値（コピペ用）:**
```
${work_hours}
```

---

#### Step 28: input_text
**説明:** 仕事内容を入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#job_description
```

**入力値（コピペ用）:**
```
${job_description}
```

---

#### Step 29: input_text
**説明:** 応募資格を入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#qualifications
```

**入力値（コピペ用）:**
```
${qualifications}
```

---

#### Step 30: input_text
**説明:** 福利厚生を入力

**操作:** `Web操作` → `テキスト入力`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#benefits
```

**入力値（コピペ用）:**
```
${benefits}
```

---

#### Step 31: select
**説明:** 掲載期間を選択

**操作:** `select`

**オプション:**
- selector: `#posting_period`
- value: `${posting_period}`
- by: `value`

---

#### Step 32: click
**説明:** プレビューボタンをクリック

**操作:** `Web操作` → `クリック`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#preview_button
```

---

#### Step 33: wait_for_screen_calms
**説明:** プレビュー画面表示待機

**操作:** `基本` → `画面安定待ち`

---

#### Step 34: click
**説明:** 公開ボタンをクリック

**操作:** `Web操作` → `クリック`

**セレクタタイプ:** CSS

**セレクタ（コピペ用）:**
```
#publish_button
```

---

#### Step 35: wait_for_screen_calms
**説明:** 公開処理完了待機

**操作:** `基本` → `画面安定待ち`

---

#### Step 36: get_text
**説明:** 公開結果メッセージを取得

**操作:** `Web操作` → `テキスト取得`

**セレクタ（コピペ用）:**
```
#result_message
```

**格納変数:** `publish_result`

---

#### Step 37: if
**説明:** 公開成功判定

**操作:** `フロー制御` → `条件分岐(IF)`

**条件（コピペ用）:**
```
${publish_result} contains '公開しました'
```

---

#### Step 38: comment
**説明:** 求人公開成功 - ログ記録

**操作:** `基本` → `コメント`

**コメント（コピペ用）:**
```
求人公開成功 - ログ記録
```

---

#### Step 39: else
**説明:** 公開失敗の場合

**操作:** `フロー制御` → `ELSE`

---

#### Step 40: comment
**説明:** 求人公開失敗 - エラーログ記録

**操作:** `基本` → `コメント`

**コメント（コピペ用）:**
```
求人公開失敗 - エラーログ記録
```

---

#### Step 41: end_if
**説明:** 公開結果判定終了

**操作:** `フロー制御` → `END IF`

---

### タブ: 処理完了・クリーンアップ
> 全処理完了後のクリーンアップと結果通知

#### Step 42: comment
**説明:** 次の企業へ移行（ループ継続）

**操作:** `基本` → `コメント`

**コメント（コピペ用）:**
```
次の企業へ移行（ループ継続）
```

---

#### Step 43: comment
**説明:** 全企業の処理完了チェック

**操作:** `基本` → `コメント`

**コメント（コピペ用）:**
```
全企業の処理完了チェック
```

---

#### Step 44: send_mail
**説明:** 処理完了通知メール送信

**操作:** `基本` → `メール送信`

**宛先（コピペ用）:**
```
${notification_email}
```

**件名（コピペ用）:**
```
Circus求人自動登録処理完了通知
```

**本文（コピペ用）:**
```
企業登録および求人公開処理が完了しました。処理件数: ${processed_count}
```

---

#### Step 45: script_exit
**説明:** スクリプト正常終了

**操作:** `フロー制御` → `スクリプト終了`

**終了ステータス:** success

**メッセージ（コピペ用）:**
```
Circus求人自動登録処理が正常に完了しました
```

---

## 3. 注意事項

- セレクタ（XPath/CSS）は実際の画面に合わせて調整が必要です
- 変数名は `^変数名^` の形式で使用します
- 画面遷移後は「画面安定待ち」を入れることを推奨します
